## histone modifications - data mapping and peak calling
ChIP-seq reads were aligned to the mouse reference genome (mm10) using Bowtie. Duplicates were removed using PICARD tools. As for H3K4me1 or H3K4me3, enriched regions (peaks) were identified using findPeaks program from HOMER software, with the setting of “-size 1000 -minDist 1000”. Peaks overlapped in both replicates of individual cell type were kept. If centers of two consecutive peaks were less than 500 bp, only the peak with higher enrichment signal was counted. H3K4me1 or H3K4me3 peak sets were generated by combining total peaks in all four HSPC samples and extending +/- 500 bp. Frequency distribution of H3K4me3 peaks were then plotted based on H3K4me3 enrichment, and peaks with high levels of H4me3 (CPM > 16) were considered to be active promoters. H3K4me1-based total enhancer catalog was created by excluding H3K4me1 peaks that intersect with active promoters, and then merging the overlapped ones. Accessible enhancers were defined as ATAC-seq consensus peaks overlapping with total enhancers. H3K27ac ChIP-seq peaks were called using MACS2 against input sample of each cell type with a p-value cutoff of 1e-9 and with setting “nomodel”. A list of H3K27ac consensus peak set was made using DiffBind. 

## Identification of leukemia-specific enhancer changes
Accessible enhancers with DM-induced significantly differential H3K4me1 were selected for plotting enhancer marks and chromatin accessibility in WT HSPC, DM HSPC, WT neutrophils (NEU) and GMP. Sequencing reads were mapped to mm10 and processed similarly as for WT HSPC. DM gained or lost enhancer groups were divided into two subgroups based on H3K4me1 enrichment patterns by k-means clustering (n = 2) using computeMatrix and plotHeatmap in deepTools. Enhancers showing unique changes in DM HSPC as compared to WT HSPC and neutrophils were considered “leukemia-specific” changes. 


## reads mapping
get_data.sh
run_getData.sh

## process reads
process_aligned_reads.sh
run_process_aligned_reads.sh

## peakcalling for H3K4me1 and H3K4me3 (using HOMER)
findpeaks.sh
run_findpeaks.sh
filter_peaks.sh
filter_overlapped_intervals.py
filterpeaks_based_on_index.py
get_catalog.py

## define H3K4me1-marked enhancers
enhancer_calling.R

## peakcalling for H3K27ac (using MACS2)
peakCalling_H3K27ac.sh
run_peakCalling_H3K27ac.sh
run_MACS.NoModel.pl






